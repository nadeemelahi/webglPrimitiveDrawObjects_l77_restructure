<!DOCTYPE html>
<html lang = "en" >
	<!--
		author: Nadeem Elahi
		private paid professional email : nad@3deem.com
		public free social media email : nadeem.elahi@gmail.com
		rogers mobile tel : 905-481-1294
		COPYRIGHT March 2025 
	-->
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<title>Nadeem's WebGL 3D graphics library v 02</title>

		<link rel="stylesheet" href="./h01_style.css">
		<link rel="icon" type="image/x-icon" href="./favicon.ico">
	</head>
	<body>
		<div id="fullscreenPage">

			<div id="fsP_fsOverlay01">
				<canvas id="fsCanvas" width="100px" height="100px"></canvas>
			</div>

			<div id="fsP_fsOverlay02">
				<h1>3deem.com</h1>
			</div>

		</div>

		<script id="vs_lamp" type="x-shader/x-vertex"> 
attribute vec4 vertex012 , shufle120 , shufle201 ;

attribute vec4 fragment ;
varying vec4 v_fragment ;

uniform float x_angle , y_angle , z_angle ;
uniform float x_loc , y_loc , z_loc ;
uniform float x_scl , y_scl , z_scl ;

float perspective ;
varying float v_perspective ;

float cosLamp ;
varying float v_cosLamp ;

void main ( void ) {

	// rotation x
	float xAngle = radians( x_angle ) ;
	float cx = cos( xAngle ) ;
	float sx = sin( xAngle ) ;

	mat4 rotateX = mat4 (

		1.0  ,  0.0  ,  0.0  ,  0.0  ,
		0.0  ,   cx  ,   sx  ,  0.0  ,
		0.0  ,  -sx  ,   cx  ,  0.0  ,
		0.0  ,  0.0  ,  0.0  ,  1.0 

	) ;

	// rotation y
	float yAngle = radians( y_angle ) ;
	float cy = cos(yAngle) ;
	float sy = sin(yAngle) ;

	mat4 rotateY = mat4(

		cy  ,  0.0  ,  -sy  ,  0.0  ,
		0.0 ,  1.0  ,  0.0  ,  0.0  ,
		sy  ,  0.0  ,   cy  ,  0.0  ,
		0.0 ,  0.0  ,  0.0  ,  1.0 

	) ;

	// rotation x
	float zAngle = radians( z_angle ) ;
	float cz = cos(zAngle) ;
	float sz = sin(zAngle) ;

	mat4 rotateZ = mat4 (

		cz   ,   sz  ,  0.0  ,  0.0  ,
		-sz  ,   cz  ,  0.0  ,  0.0  ,
		0.0  ,  0.0  ,  1.0  ,  0.0  ,
		0.0  ,  0.0  ,  0.0  ,  1.0 

	) ;

	mat4 scale = mat4(

		x_scl  ,  0.0    ,  0.0    ,  0.0  ,
		0.0    ,  y_scl  ,  0.0    ,  0.0  ,
		0.0    ,  0.0    ,  z_scl  ,  0.0  ,
		0.0    ,  0.0    ,  0.0    ,  1.0  

	) ;

	mat4 translation = mat4(

		1.0   ,  0.0   ,  0.0   ,  0.0  ,
		0.0   ,  1.0   ,  0.0   ,  0.0  ,
		0.0   ,  0.0   ,  1.0   ,  0.0  ,
		x_loc ,  y_loc ,  z_loc ,  1.0 

	) ;

	// position
	vec4 pos012 = vertex012 ;
	vec4 pos120 = shufle120 ;
	vec4 pos201 = shufle201 ;

	mat4 rotation = rotateX * rotateY * rotateZ ;
	mat4 srt = translation * rotation * scale ;

	vec4 pos = pos012 + pos120 + pos201 - pos120 - pos201 ;
	pos012 = srt * pos012 ; 
	pos120 = srt * pos120 ; 
	pos201 = srt * pos201 ; 

	vec3 lineA = pos120.xyz - pos012.xyz ;
	vec3 lineB = pos120.xyz - pos201.xyz ;

	vec3 normalAB = normalize ( cross( lineA , lineB ) ) ;

	vec3 lamp = vec3( 0.0 , 0.0 , 1.0 ) ;

	float cosLamp = dot( lamp , normalAB ) ;

	if ( cosLamp < 0.0 ) {

		cosLamp *= -1.0 ;
	}

	if ( cosLamp < 0.2 ) {

		cosLamp = 0.2 ;
	}


	// [ near , far ]
	// [ -1 , 0 , 1 ] -> [ 1 , 0.5 , 0 ]
	perspective = ( 1.0 - pos012.z ) / 2.0 ;
	// if z = -1 , perspective = 1
	//    z =  0 , perspective = 0.5
	//    z =  1 , perspective = 0
	pos012.w = 1.0 / perspective ;

	// set position 
	gl_Position = pos012 ;

	// pass fragment data
	v_fragment = fragment ;
	v_perspective = perspective ;
	v_cosLamp = cosLamp ;
}

		</script>
		<script id="fs_lamp" type="x-shader/x-fragment"> 
precision mediump float ;

varying vec4 v_fragment ;
varying float v_perspective ;
varying float v_cosLamp ;

void main ( void ) {

	//vec4 red = vec4( 1.0 , 0.0 , 0.0 , 1.0 ) ;
	// each channel
	float red = v_fragment.r * v_cosLamp ;
	float green = v_fragment.g * v_cosLamp ;
	float blue = v_fragment.b * v_cosLamp ;
	//float alpha = v_fragment.a;
	float alpha = v_perspective ;

	gl_FragColor = vec4( red , green , blue , alpha ) ;
}

		</script>

		<script src="./j00_ngl.js"></script>

		<!--
		<script src="./j01_dataUtil.js"></script>
		-->

		<script src="./j02_vecUtil.js"></script>

		<script src="./j11_ngl.shaderLamp.js"></script>
		<script src="./j12_ShaderLampData.js"></script>
		<script src="./j13_ShaderLampDrawObject.js"></script>


		<script src="./j14_Triangle.js"></script>
		<script src="./j15_Quad.js"></script>
		<script src="./j16_Circle.js"></script>
		<script src="./j18_EquilateralPyramid.js"></script>

		<script src="./j19_Cone.js"></script>
		<script src="./j20_Cube.js"></script>
		<script src="./j21_Cylinder.js"></script>
		<script src="./j22_CylinderByEndPoints.js"></script>
		<script src="./j23_SphereLatLongRings.js"></script>

		<script src="./j25_ballSocket.js"></script>

		<script src="./l00_timer.js"></script>
		<script src="./l01_triangleDrawA01.js"></script>
		<script src="./l02_quadDrawA01.js"></script>
		<script src="./l03_circleDrawA01.js"></script>
		<script src="./l04_equilateralPyramidDrawA01.js"></script>
		<script src="./l05_coneDrawA01.js"></script>
		<script src="./l06_cubeDrawA01.js"></script>
		<script src="./l07_cylinderDrawA01.js"></script>
		<script src="./l08_cylinderByEndPointsDrawA01.js"></script>
		<script src="./l09_sphereLatLongRingsDrawA01.js"></script>
		<script src="./l10_ballSocketDrawA01.js"></script>
		<script src="./l76_loadDrawData.js"></script>
		<script src="./l77_app.js"></script>

	</body>
</html>
